<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./style/style.css">
    <script src="https://code.jquery.com/jquery-3.4.0.min.js"></script>
    <title>ZaraHome</title>
</head>
<body>
    <div class="survey-container">
            <div class="wrapper">
                <div class="logo-box">
                    <img src="./img/logo.svg" alt="logo">
                </div>
                <div class="main-question-box">
                    <p class="q-text">
                        Пожалуйста, оставьте свои контакты для связи с вами...
                    </p>
                </div>
            </div>
        <form id="contacts-form" action="">
            <div class="gray-block contacts-gray-block">
                <div class="wrapper">
                    <div class="line"></div>
                    <div class="contact-box">
                        <p class="contact-label name-label">Ваше имя</p>
                        <input class="data-field" id="name" name="name" type="text" data-reqired>
                        <p class="data-error"></p>
                    </div>
                    <div class="contact-box">
                        <p class="contact-label phone-label">Ваш номер телефона</p>
                        <input class="data-field only-numbers" id="phone" name="phone" type="text" data-reqired>
                        <p class="data-error"></p>
                    </div>
                    <div class="contact-box">
                        <p class="contact-label email-label">Ваш EMAIL</p>
                        <input class="data-field" id="email" name="email" type="text" data-reqired>
                        <p class="data-error invalid_email">* Неправильный электронный адрес</p>
                    </div>
                </div>
            </div>
            <div class="contacts-submit-wrapper">
                <button class="save-btn">Сохранить</button>
            </div>
        </form>
    </div>
    <script>

        let onlyNumbers = document.querySelectorAll('.only-numbers');
        for (let i = 0; i < onlyNumbers.length; i++) {
            onlyNumbers[i].onkeypress = (e) => {
                if (e.keyCode < 48 || e.keyCode > 57) {
                    return false;
                }
            };
        }

        const form = document.getElementById('contacts-form');
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            let el = document.querySelectorAll('[data-reqired]');
            console.log(el)
            let erroreArrayElemnts = [];
            for (var i = 0; i < el.length; i++) {
                if (el[i].value === '') {
                    $(el[i]).parents('.contact-box').find('.data-error').show();
                    $(el[i]).parents('.contact-box').find('.data-error').text('* Поле обязательно к заполнению');
                    erroreArrayElemnts.push(el[i]);
                }

                $(el[i]).on('focus', function () {
                    $(this).parents('.contact-box').find('.data-error').hide();
                });

                // if ($('#phone').val().length < 16 && $('#phone').val() !== '') {
                //     $('#phone').parents('.contact-box').find('.data-error').show();
                //     $('#phone').parents('.contact-box').find('.data-error').text('Пожалуйста, проверьте корректность заполнения поля "Телефон"');
                //     erroreArrayElemnts.push(el[i]);
                // }

                if (!ValidateEmail($("#email").val())) {
                    erroreArrayElemnts.push('invalid_email');
                    $('#email').parents('.contact-box').find('.invalid_email').show();
                }
            }
            if (erroreArrayElemnts.length == 0) {
                form.submit();
            }
        });
        function ValidateEmail(email) {
            var expr = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
            return expr.test(email);
        }
    </script>
</body>
</html>